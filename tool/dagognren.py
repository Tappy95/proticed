import requests
import json

mapping_userId_dict = {
    "赵伟铭": 681,
    "苏佩虹": 688,
    "廖细香": 690,
    "陈海丽": 691,
    "简金源": 693,
    "罗玉婷": 695,
    "江志勇": 702,
    "谈雍": 708,
    "赵志坚": 713,
    "赵鹏": 720,
    "刘经秀": 722,
    "李静雯": 731,
    "刘雪梅": 734,
    "梁艳芳": 736,
    "伍嘉敏": 738,
    "胡敏": 741,
    "李志洪": 744,
    "邓碧华": 747,
    "唐子媚": 757,
    "曾婵芳": 761,
    "贺典": 764,
    "李益香": 768,
    "张青霞": 774,
    "黄倩瑜": 778,
    "李玉婷": 788,
    "黄超宇": 789,
    "董丽英": 791,
    "蔡薇薇": 797,
    "江家惠": 798,
    "沈鹏伟": 825,
    "王敏冰": 831,
    "邓雪芬": 836,
    "李泽锋": 844,
    "李云青": 874,
    "周雪娟": 876,
    "覃周娣": 877,
    "段骋森": 898,
    "张攀": 900,
    "梁冬润": 909,
    "田壮虎": 910,
    "刘钧予": 911,
    "何晓辉": 1640,
    "罗河育": 1769,
    "陈丽容": 1776,
    "张炳顺": 1783,
    "翟宇华": 1802,
    "符文秀": 1803,
    "杨慧梅": 1806,
    "郑景瑜": 1807,
    "邱秀芬": 1811,
    "杨玩玲": 1812,
    "吴少霞": 1865,
    "豆娟": 1868,
    "贾红银": 1878,
    "谢俞明": 1894,
    "黄雪梅": 1897,
    "郑洁文": 1914,
    "薛俊杰": 1956,
    "俞丽燕": 1986,
    "陈嘉雯": 1990,
    "张婉玉": 2001,
    "陈飞燕": 2023,
    "岭南": 2056,
    "杨建忠": 2065,
    "林志辉": 2066,
    "叶敏清": 2073,
    "朱秋伊": 2096,
    "陈尚宁": 2122,
    "罗玉玲": 2134,
    "王贤文": 2138,
    "江志烽": 2139,
    "黄银娟": 2146,
    "舒栋业": 2155,
    "黄镜洁": 2160,
    "张鸣宇": 2168,
    "路贵涛": 2182,
    "陈欣媚": 2200,
    "贾定东": 2219,
    "程文爱": 2234,
    "邹华光": 2263,
    "伍春炫": 2284,
    "陈博": 2287,
    "吴道虎": 2297,
    "贺庚银": 2305,
    "刘望博": 2308,
    "陈泽凯": 2323,
    "范彩霞": 2328,
    "欧建伟": 2336,
    "罗杰森": 2341,
    "关振山": 2346,
    "黄艳": 2347,
    "蒋玉翠": 2348,
    "刘冠": 2349,
    "梁钟": 2369,
    "陈伟婷": 2378,
    "李燕霞": 2392,
    "戚雯": 2401,
    "欧丹丹": 2412,
    "李志民": 2417,
    "毛建顺": 2425,
    "郭少佳": 2429,
    "黄艳艳": 2430,
    "庞心怡": 2440,
    "黎艳漫": 2461,
    "张嘉茹": 2473,
    "李珏瑜": 2478,
    "黄紫婷": 2482,
    "魏梦瑶": 2486,
    "周骏": 2495,
    "韩思翠": 2497,
    "邱森明": 2500,
    "刘伟聪": 2509,
    "林冬菊": 2512,
    "许文霞": 2515,
    "吴舒": 2517,
    "邹许乐": 2525,
    "陈建锋": 2526,
    "梁益俊": 2527,
    "蔡荣智": 2540,
    "庞正辉": 2543,
    "曾庆斯": 2544,
    "杨佳莹": 2548,
    "余曼榕": 2550,
    "梁汝晴": 2551,
    "周嘉恒": 2552,
    "李健莹": 2560,
    "罗信": 2562,
    "李恬": 2565,
    "温菁": 2566,
    "欧阳慧霞": 2570,
    "颜泳仪": 2571,
    "曹洪铭": 2573,
    "伍绍芽": 2583,
    "赵美聪": 2595,
    "吴艺真": 2600,
    "叶春霞": 2605,
    "魏天华": 2627,
    "梁豪": 2631,
    "傅淦钊": 2634,
    "古艳洋": 2637,
    "郑小亚": 2652,
    "古芯临": 2653,
    "刘翠灵": 2676,
    "刘艳芳": 2680,
    "张莹霞": 2708,
    "陈济权": 2763,
    "邹声桂": 2866,
    "黄雅媚": 2906,
    "李舒慧": 2907,
    "冯荣": 2971,
    "李梅芳": 2974,
    "陈仔文": 2986,
    "卢欣怡": 3030,
    "欧阳媛文": 3032,
    "吴慧婷": 3033,
    "张莎莎": 3034,
    "黄秋蓉": 2918105,
    "陈梅灿": 2918107,
    "胡涛": 2918109,
    "李彦霖": 3075,
    "朱颖怡": 2918113,
    "麦仲谦": 2918115,
    "邱伟洪": 2918119,
    "黄醒波": 2918120,
    "周翔": 2918122,
    "陆芳婷": 2918123,
    "谢红萍": 2918124,
    "梁梦桦": 2918126,
    "潘志君": 2918128,
    "陈倩婷": 2918133,
    "罗晓怡": 2918134,
    "麦伟贞": 2918135,
    "何智环": 2918136,
    "张仲杰": 2918137,
    "林正凤": 2918140,
    "吴裕诗": 2918141,
    "李淑玲": 2918142,
    "彭晓玲": 2918145,
    "董梓玲": 2918148,
    "林楚容": 2918149,
    "陈杏娟": 2918150,
    "廖文珊": 2918153,
    "王申": 2918154,
    "甘婕": 2918155,
    "赵娟": 2918157,
    "梁思婷": 2918158,
    "张晓丹": 2918159,
    "黎莹莹": 2918160,
    "张晓雯": 2918161,
    "张滢萍": 2918162,
    "梁正菊": 2918165,
    "郑俊云": 2918167,
    "张晓林": 2918169,
    "李可欣": 2918170,
    "周金辉": 3169,
    "刘紫旋": 2918176,
    "唐伟健": 2918177,
    "莫永喜": 2918178,
    "黄燕旋": 2918179,
    "郑绍晨": 2918180,
    "姚佳妍": 2918182,
    "梁嘉淇": 2918187,
    "温婷": 2918189,
    "周红苑": 2918192,
    "李华娟": 2918194,
    "宋奕贤": 2918195,
    "李鹏": 3049,
    "张华锋": 3197,
    "郭涛": 3076,
    "肖雅婷": 3199,
    "叶剑浩": 2918202,
    "冼鹏飞": 2918203,
    "时佳俊": 2918206,
    "刘日春": 2918207,
    "李金兰": 2918209,
    "龙莹": 2918210,
    "张伟": 2918212,
    "江艳": 2918213,
    "廖骏": 2918214,
    "徐洪聪": 2918215,
    "李灿如": 2918216,
    "张鑫蜜": 2918217,
    "林志强": 2918218,
    "覃诗雅": 2918219,
    "邓作睁": 2918220,
    "赵仕剑": 2918221,
    "朱金玉": 2918222,
    "张弛": 2918223,
    "陆映桃": 2918224,
    "欧阳栋": 2918225,
    "赵进展": 3252,
    "潘志成": 2918232,
    "罗志娟": 2918233,
    "吴孟龙": 2918234,
    "何荣彬": 2918235,
    "钟洪坤": 2918236,
    "王留见": 2918237,
    "李晓红": 2918425,
    "郭金燕": 2918515,
    "林燕菁": 2918622,
    "李伟洪": 2918628,
    "施玲玲": 2918635,
    "江祖年": 2918643,
    "刘益雷": 2918648,
    "秦旭佳": 2918649,
    "谢燕红": 2918653,
    "曾佳": 2918660,
    "王琦": 2918662,
    "高爱媚": 2918680,
    "余金惠": 2918686,
    "张向妹": 2918694,
    "姜晴文": 2918696,
    "杨佩映": 2918703,
    "谢昆连": 2918711,
    "何嘉懿": 2918712,
    "李夏萍": 2918715,
    "苏济宁": 2918716,
    "王建康": 2918718,
    "董子刚": 2918719,
    "林俊宇": 2918722,
    "龙俊钧": 2918723,
    "郑彦琳": 2918724,
    "陈丽敏": 2918725,
    "李培辉": 2918726,
    "刘聪": 2918727,
    "叶观益": 2918728,
    "胡焕坤": 2918729,
    "张晓红": 2918730,
    "张茜": 2918731,
    "林义汇": 2918732,
    "施晓敏": 2918733,
    "曾月君": 2918734,
    "卢秋玲": 2918735,
    "谢艳丹": 2918736,
    "朱文婷": 2918737,
    "林苑": 2918738,
    "赖聪": 2918740,
    "陈婵": 2918742,
    "彭俊旺": 2918743,
    "郭恺芊": 2918744,
    "吴锐": 2918745,
    "何婷": 2918746,
    "韦灿灿": 2918748,
    "廖显妙": 2918750,
    "林正豪": 2918751,
    "李耀连": 2918753,
    "谭侣杰": 2918754,
    "严玉勤": 2918756,
    "覃倩": 2918757,
    "范兴桂": 2918760,
    "潘洪辉": 2918761,
    "赵煜": 2918765,
    "黄桐云": 2918770,
    "曾海媚": 2918773,
    "黄嘉发": 2918780,
    "蔡灿选": 2918784,
    "李文": 2918787,
    "胡骆宾": 2918791,
    "李一兴": 2918797,
    "刘铁季": 2918805,
    "聂丽暖": 2918810,
    "谢嘉泳": 2918811,
    "田洪花": 2918818,
    "程演英": 2918824,
    "华锋": 2918864,
    "毛春梅": 2918871,
    "马笑": 2918878,
    "寇微兰": 2918881,
    "林作锦": 2918891,
    "李金柱": 2918896,
    "万志兰": 2918898,
    "刘荣茂": 2918906,
    "李伟庆": 2918921,
    "杨慧青": 2918924,
    "黄锦民": 2918941,
    "江伟雄": 2918945,
    "利雪娟": 2918983,
    "李海权": 2919310,
    "梁敏": 2919492,
    "黄亦媚": 2919512,
    "刘繁": 2919732,
    "邹家坤": 2919733,
    "谭子员": 2919734,
    "薛燕笑": 2919735,
    "梁燕娴": 2919736,
    "崔江霞": 2919738,
    "李凤玲": 2919739,
    "李云珍": 2919740,
    "谭斌仂": 2919742,
    "高得胜": 2919743,
    "梁国良": 2919745,
    "曾宇和": 2919746,
    "洪仁举": 2919747,
    "谢纯": 2919748,
    "唐衍芬": 2919750,
    "周星校": 2919751,
    "黄玲": 2919752,
    "杨帆": 2919753,
    "李畅婷": 2919754,
    "胡攀": 2919755,
    "黄晓君": 2919757,
    "周明慧": 2919758,
    "谢志刚": 2919759,
    "林学振": 2919760,
    "杨健": 2919761,
    "杨小慧": 2919762,
    "余雯汐": 2919765,
    "肖孟孟": 2919767,
    "赵新伟": 2919768,
    "吴继蓬": 2919769,
    "林婉冰": 2919770,
    "黄晔": 2919771,
    "徐毅": 2919773,
    "张景坤": 2919774,
    "苏志成": 2919775,
    "孙光泽": 2919776,
    "莫亚静": 2919777,
    "黎广榕": 2919778,
    "黎丰帆": 2919779,
    "杨思婷": 2919780,
    "黎天明": 2919781,
    "黄晓珍": 2919782,
    "李燕聪": 2919784,
    "谭琴": 2919785,
    "罗绍霞": 2919786,
    "唐忠": 2919787,
    "张星霞": 2919788,
    "叶柏良": 2919789,
    "何瑞德": 2919790,
    "蔚坤": 2919791,
    "练家丽": 2919792,
    "陈群英": 2919793,
    "符动收": 2919794,
    "刘可可": 2919796,
    "林官英": 2919797,
    "潘雨苗": 2919798,
    "苏秋莲": 2919799,
    "梁清梅": 2919800,
    "唐克方": 2919801,
    "苏琼英": 2919802,
    "刀丽英": 2919803,
    "谭莹莹": 2919805,
    "练红姣": 2919806,
    "李加加": 2919807,
    "巫应鹏": 2919808,
    "朱琴": 2919809,
    "姚慧": 2919810,
    "李家菌": 2919811,
    "韦周柳": 2919812,
    "李霞": 2919813,
    "赖海琪": 2919814,
    "叶钦": 2919815,
    "刘蓉": 2919816,
    "潘梅凤": 2919817,
    "黄焱明": 2919818,
    "李琪": 2919819,
    "顾云轩": 2919820,
    "潘志坚": 2919821,
    "蒙可杰": 2919822,
    "赵家珊": 2919823,
    "黎金宁": 2919824,
    "黄锐尧": 2919846,
    "林正梅": 2919847,
    "胡志煌": 2919848,
    "张永勤": 2919850,
    "王永发": 2919851,
    "江浩": 2919852,
    "盛敏": 2919854,
    "黎少琪": 2919883,
    "周小英": 2919884,
    "潘志敏": 2919885,
    "陈培芬": 2919886,
    "张文勇": 2919887,
    "犹小强": 2919888,
    "宋欢欢": 2919891,
    "李换香": 2919892,
    "谢华": 2919893,
    "庄归年": 2919894,
    "郑慧蓝": 2919895,
    "郑桐军": 2919896,
    "阳小平": 2919897,
    "李爱相": 2919899,
    "秦旭生": 2919900,
    "赖世聪": 2919901,
    "唐冠生": 2919902,
    "徐美玲": 2919903,
    "李立环": 2919904,
    "张秋霞": 2919905,
    "张文仲": 2919906,
    "邓永妃": 2919907,
    "姚伟健": 2919908,
    "古秋方": 2919909,
    "何华": 2919910,
    "祝立志": 2919911,
    "杨家记": 2919912,
    "黄坚": 2919914,
    "李亨": 2919915,
    "欧超杰": 2919916,
    "陈广俊": 2919917,
    "谯永东": 2919918,
    "陈燕锋": 2919919,
    "安广胜": 2919920,
    "刘涛": 2919921,
    "黎诗敏": 2919922,
    "赖正林": 2919923,
    "零振兴": 2919924,
    "田进进": 2919928,
    "余坤": 2919930,
    "吴宝罗": 2919931,
    "张芳强": 2919933,
    "黄伍": 2919934,
    "钟园": 2919935,
    "伍芳华": 2919936,
    "黄承波": 2919937,
    "黄活马": 2919938,
    "黄剑雄": 2919939,
    "李裕龙": 2919940,
    "冯会娟": 2919941,
    "贾贺霞": 2919942,
    "李晓辉": 2919943,
    "连静静": 2919944,
    "曾玉兰": 2919945,
    "林伟涛": 2919946,
    "陆求保": 2919947,
    "杨老根": 2919948,
    "张雄文": 2919951,
    "黄庆新": 2919958,
    "欧剑伟": 2919959,
    "黄惠芳": 2919961,
    "张桂莲": 2919962,
    "杨红粉": 2919964,
    "易双玉": 2919965,
    "郭小龙": 2919967,
    "郑江": 2919968,
    "唐上彬": 2919969,
    "张向明": 2919970,
    "卢雪荣": 2919971,
    "方青青": 2919972,
    "黄慈展": 2919973,
    "寇欣兰": 2919974,
    "林映格": 2919975,
    "黄玥": 2919976,
    "谭恩球": 2919977,
    "苏小翠": 2919978,
    "成娇": 2919979,
    "潘老丁": 2919981,
    "潘志林": 2919982,
    "邓卓尧": 2919983,
    "莫倩兰": 2919985,
    "叶小兰": 2919986,
    "彭全贵": 2919987,
    "覃群娣": 2919989,
    "黄小月": 2919990,
    "余彩芬": 2919991,
    "何水莲": 2919992,
    "赖剑波": 2919993,
    "阮亦心": 2919994,
    "王伟丽": 2919996,
    "杨湘婷": 2919998,
    "唐浩": 2919999,
    "李嘉碧": 2920001,
    "冯权聪": 2920002,
    "许嗣凤": 2920003,
    "梁春": 2920004,
    "周嘉辉": 3568,
    "陈嘉贤": 2920027,
    "唐樱芹": 2920274,
    "李丽文": 2920285,
    "林彦祥": 2920416,
    "黄月": 2920831,
    "黄玉萍": 2920832,
    "吴光怡": 2920834,
    "梁翠雯": 2920835,
    "张创凯": 3605,
    "Steven Chen": 2956,
    "龙涛": 3740,
    "周泗强": 3728,
}


def run(name: str):
    if mapping_userId_dict.get(name, None):
        res = requests.get(f'https://api.oa.bailuntec.com/api/Login/GetUserID?ID={mapping_userId_dict[name]}')
        token = json.loads(res.text)['result']

        res = requests.get(
            f'https://api.oa.bailuntec.com/api/MyMessageManage/GetWageDetailsAsync?Token={token}&PageIndex=1&PageNumber=10')
        info = json.loads(res.text)
        print(info)
        return info
    else:
        return "未收录该员工account, 请先将员工信息添加至 mapping_userId_dict"


def format_table(wageInfo: dict):
    fmt = '{:11} | {:^8} | {:^16} | {:^20} | {:^9.1f} | {:^9.1f} | {:^6.2f} | {:^8.1f} | {:^8.2f} | {:^9.2f}'
    if wageInfo['result']['dataList']:
        print('{:15} | {:^8} | {:^18} | {:^23} | {:^5} | {:^7} | {:^5} | {:^5} | {:^6} | {:^9}'.format(
            " ", "姓名", "职位", "所在公司", "基础工资", "绩效", "社保", "公积金", "个税", "实发"
        ))
        for item in wageInfo['result']['dataList']:
            details_info = item['wageDetailsData']
            print(
                fmt.format(item["title"], details_info["ai_user_name"], details_info["ai_job"],
                           details_info["bailun_company_name"][:7], details_info["ai_basic_money"],
                           details_info["ai_shijijixiao"], details_info["ai_shebao"],
                           details_info["ai_gongjijin"],
                           details_info["ai_yingjiaogeshui"], details_info["ai_shifa"]))
    else:
        print("未查询到工资信息, 请核对该员工 mapping_userId_dict 是否正确~!")


if __name__ == '__main__':
    while True:
        user_name = str(input("请输入打工人姓名: ")).strip()
        wage_info = run(user_name)
        if isinstance(wage_info, str):
            print(wage_info)
        else:
            format_table(wage_info)
